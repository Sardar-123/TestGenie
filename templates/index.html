<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TestGenie</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-5">
    <h2>TestGenie</h2>
    <form method="POST" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="file" class="form-label">Upload File</label>
            <input class="form-control" type="file" name="file" id="file" required>
        </div>
        <div class="mb-3">
            <label for="test_type" class="form-label">Testing Type</label>
            <select class="form-select" name="test_type" id="test_type" required>
                {% for t in test_types %}
                <option value="{{ t }}">{{ t }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="test_level" class="form-label">Testing Level</label>
            <select class="form-select" name="test_level" id="test_level" required>
                {% for l in test_levels %}
                <option value="{{ l }}">{{ l }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="industry" class="form-label">Industry</label>
            <select class="form-select" name="industry" id="industry" required>
                {% for i in industries %}
                <option value="{{ i }}">{{ i }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="output_format" class="form-label">Test Case Output Format</label>
            <select class="form-select" name="output_format" id="output_format" required>
                {% for fmt in output_formats %}
                <option value="{{ fmt }}">{{ fmt }}</option>
                {% endfor %}
                <option value="API (Code)">API (Code)</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="num_cases" class="form-label">Number of Test Cases</label>
            <input type="number" class="form-control" name="num_cases" id="num_cases" min="1" max="20" value="5" required>
        </div>
        <div class="mb-3" id="language_select_div" style="display:none;">
            <label for="code_language" class="form-label">Code Output Language</label>
            <select class="form-select" name="code_language" id="code_language">
                <option value="Python">Python</option>
                <option value="JavaScript">JavaScript</option>
                <option value="Java">Java</option>
            </select>
        </div>
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="generate_ai" name="generate_ai">
            <label class="form-check-label" for="generate_ai">Generate AI Test Cases</label>
        </div>
        <!-- <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="strict_scenarios" name="strict_scenarios">
            <label class="form-check-label" for="strict_scenarios">Generate only for provided scenarios</label>
        </div> -->
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="alert alert-warning mt-3">
          {{ messages[0] }}
        </div>
      {% endif %}
    {% endwith %}
    {% if preview %}
        <div class="alert alert-info mt-3">{{ preview|safe }}</div>
    {% endif %}
    {% if generated_cases %}
        <div class="alert alert-success mt-3">
            <pre style="white-space: pre-wrap; background: #f8f9fa; border-radius: 5px; padding: 1em;">{{ generated_cases | e }}</pre>
        </div>
        <a href="{{ url_for('download_test_cases') }}" class="btn btn-success mt-2">Download Test Cases (.txt)</a>
    {% endif %}
</div>
<script>
// Show language selection for code/script output formats
document.addEventListener('DOMContentLoaded', function() {
    var outputFormat = document.getElementById('output_format');
    var langDiv = document.getElementById('language_select_div');
    function toggleLang() {
        if (["Selenium", "Cypress", "Playwright", "API (Code)"].includes(outputFormat.value)) {
            langDiv.style.display = '';
        } else {
            langDiv.style.display = 'none';
        }
    }
    outputFormat.addEventListener('change', toggleLang);
    toggleLang();
});
</script>
</body>
</html>